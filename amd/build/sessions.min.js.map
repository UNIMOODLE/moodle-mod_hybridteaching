{"version":3,"file":"sessions.min.js","sources":["../src/sessions.js"],"sourcesContent":["define([\n    'core/ajax',\n], function(ajax) {\n    const sessionexempt = (e) => {\n        var sess = e.currentTarget;\n        var sessid = sess.dataset.id;\n        if (sess.checked) {\n            set_session_exempt(sessid, 1);\n        } else {\n            set_session_exempt(sessid, 0);\n        }\n    };\n\n    const get_modal = (e) => {\n        e.preventDefault();\n        let sess = e.currentTarget;\n        let sessid = sess.dataset.id;\n        get_modal_text(sessid);\n    };\n\n    /**\n     * Sets manual attendance\n     *\n     * @param {integer} sessid\n     * @param {array} attexempt\n     * @returns response with the modified slot information.\n     */\n    const set_session_exempt = (sessid, attexempt) => ajax.call([{\n        methodname: 'mod_hybridteaching_set_session_exempt',\n        args: {\n            sessid,\n            attexempt,\n        },\n    }])[0].done( response => {\n        return response;\n    }).fail( err => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n    });\n\n    const get_modal_text = (sessid) => ajax.call([{\n        methodname: 'mod_hybridteaching_get_modal_text',\n        args: {\n            sessid,\n        },\n    }])[0].done(response => {\n        const parsedResponse = JSON.parse(response);\n        document.querySelector(\"#sessionamemodal\").innerHTML = parsedResponse.sessname;\n        if (parsedResponse.sesspass != undefined && parsedResponse.sesspass != \"\") {\n            document.querySelector(\"#sessionpassmodal\").innerHTML = parsedResponse.sesspass;\n        }\n\n        if (parsedResponse.sessurl != undefined && parsedResponse.sessurl != \"\") {\n            document.querySelector(\"#sessionurlmodal\").innerHTML = parsedResponse.sessurl;\n        }\n    }).fail( err => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n    });\n\n    return {\n        init: () => {\n            document.getElementById('id_perpage').onchange = function() {\n                var formPrefix = 'mform3';\n                var formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                if (formElement) {\n                    formElement.submit();\n                }\n            };\n\n            const sessinfo = document.querySelectorAll('.sessinfo');\n            sessinfo.forEach(sess => {\n                sess.addEventListener('click', get_modal, true);\n            });\n\n            const attsess = document.querySelectorAll('.attexempt');\n            attsess.forEach(sess => {\n                sess.addEventListener('change', sessionexempt, true);\n            });\n        }\n    };\n});"],"names":["define","ajax","sessionexempt","e","sess","currentTarget","sessid","dataset","id","checked","set_session_exempt","get_modal","preventDefault","get_modal_text","attexempt","call","methodname","args","done","response","fail","err","console","log","parsedResponse","JSON","parse","document","querySelector","innerHTML","sessname","undefined","sesspass","sessurl","init","getElementById","onchange","formElement","submit","querySelectorAll","forEach","addEventListener"],"mappings":"AAAAA,qCAAO,CACH,cACD,SAASC,YACFC,cAAiBC,QACfC,KAAOD,EAAEE,cACTC,OAASF,KAAKG,QAAQC,GACtBJ,KAAKK,QACLC,mBAAmBJ,OAAQ,GAE3BI,mBAAmBJ,OAAQ,IAI7BK,UAAaR,IACfA,EAAES,qBAEEN,OADOH,EAAEE,cACKE,QAAQC,GAC1BK,eAAeP,SAUbI,mBAAqB,CAACJ,OAAQQ,YAAcb,KAAKc,KAAK,CAAC,CACzDC,WAAY,wCACZC,KAAM,CACFX,OAAAA,OACAQ,UAAAA,cAEJ,GAAGI,MAAMC,UACFA,WACRC,MAAMC,MAELC,QAAQC,IAAIF,QAGVR,eAAkBP,QAAWL,KAAKc,KAAK,CAAC,CAC1CC,WAAY,oCACZC,KAAM,CACFX,OAAAA,WAEJ,GAAGY,MAAKC,iBACFK,eAAiBC,KAAKC,MAAMP,UAClCQ,SAASC,cAAc,oBAAoBC,UAAYL,eAAeM,SACvCC,MAA3BP,eAAeQ,UAAoD,IAA3BR,eAAeQ,WACvDL,SAASC,cAAc,qBAAqBC,UAAYL,eAAeQ,UAG7CD,MAA1BP,eAAeS,SAAkD,IAA1BT,eAAeS,UACtDN,SAASC,cAAc,oBAAoBC,UAAYL,eAAeS,YAE3Eb,MAAMC,MAELC,QAAQC,IAAIF,cAGT,CACHa,KAAM,KACFP,SAASQ,eAAe,cAAcC,SAAW,eAEzCC,YAAcV,SAASC,cAAc,kBACrCS,aACAA,YAAYC,UAIHX,SAASY,iBAAiB,aAClCC,SAAQpC,OACbA,KAAKqC,iBAAiB,QAAS9B,WAAW,MAG9BgB,SAASY,iBAAiB,cAClCC,SAAQpC,OACZA,KAAKqC,iBAAiB,SAAUvC,eAAe"}