{"version":3,"file":"formconfig.min.js","sources":["../src/formconfig.js"],"sourcesContent":["// This file is part of Moodle - https://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * The main mod_hybridteaching configuration form js.\n *\n * @package     mod_hybridteaching\n * @copyright   2023 isyc <isyc@example.com>\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Get all selectors in one place.\n *\n */\nconst ELEMENT_SELECTOR = {\n    useAttendance: () => document.getElementById('id_useattendance'),\n    useVC: () => document.getElementById('id_usevideoconference'),\n    useVCRecord: () => document.getElementById('id_userecordvc'),\n    typeVC: () => document.getElementById('id_typevc'),\n    recordOptions: () => document.getElementById('id_sectionrecording'),\n    sectionAttendance: () => document.getElementById('id_sectionattendance'),\n    sectionAccess: () => document.getElementById('id_sectionsessionaccess'),\n    sectionInitialStates: () => document.getElementById('id_sectioninitialstates'),\n    sectionAudience: () => document.getElementById('id_sectionaudience'),\n    participantList: () => document.getElementsByName('participants')[0],\n    modStandardGrade: () => document.getElementById('id_modstandardgrade'),\n    sessionscheduling: () => document.getElementById('id_sessionscheduling'),\n    permisionscontainer: () => document.getElementById('id_sectionaudiencecontainer'),\n};\n\nexport const init = () => {\n    /**\n     * page load\n     */\n    oldtypevc = ELEMENT_SELECTOR.typeVC().value;\n    useVC();\n    useAttendance();\n    useSessionsScheduling();\n    //\n    ELEMENT_SELECTOR.useVCRecord().addEventListener('change', (e) => useVCRecord(e));\n    ELEMENT_SELECTOR.useVC().addEventListener('change', (e) => useVC(e));\n    ELEMENT_SELECTOR.useAttendance().addEventListener('change', (e) => useAttendance());\n    ELEMENT_SELECTOR.sessionscheduling().addEventListener('change', (e) => useSessionsScheduling());\n    ELEMENT_SELECTOR.permisionscontainer().querySelector('[name=\"hybridteaching_participant_selection\"').disabled = true;\n}\n\nconst useSessionsScheduling = (e = ELEMENT_SELECTOR.sessionscheduling()) => {\n    let sessionscheduling = ELEMENT_SELECTOR.sessionscheduling();\n    let sectionsessions = sessionscheduling.closest('#id_sectionsessions');\n    if (is_checkbox_checked(e) && is_element_displayed(e)) {\n        sectionsessions.querySelector('#fitem_id_starttime').setAttribute('style', 'display:none');\n        sectionsessions.querySelector('#fgroup_id_durationgroup').setAttribute('style', 'display:none');\n        sectionsessions.querySelector('#id_duration').value = 0;\n        sectionsessions.querySelector('#id_starttime_enabled').checked = 0;\n        \n    } else {\n        sectionsessions.querySelector('#fitem_id_starttime').setAttribute('style', 'display:flex');\n        sectionsessions.querySelector('#fgroup_id_durationgroup').setAttribute('style', 'display:flex');\n        sectionsessions.querySelector('#fitem_id_starttime').value = 0;\n\n    }\n    \n}\n\nconst useAttendance = (e = ELEMENT_SELECTOR.useAttendance()) => {\n    let sectionAttendance = ELEMENT_SELECTOR.sectionAttendance();\n    let formi = sectionAttendance.getElementsByTagName('INPUT');\n    let modStandardGrade = ELEMENT_SELECTOR.modStandardGrade();\n    let gradeformselect = modStandardGrade.getElementsByTagName('SELECT')[0];\n    if (is_checkbox_checked(e) && is_element_displayed(e)) {\n        formi.forEach(input => {\n            if (input.type !== 'hidden' && input.type !== 'text') {\n                input.value = 1;\n            }  \n        });\n        sectionAttendance.setAttribute('style', 'display:block');\n\n        gradeformselect.value = 'point';\n        modStandardGrade.setAttribute('style', 'display:block');\n    } else {\n        formi.forEach(input => {\n            if (input.type !== 'hidden') {\n                input.value = '';\n            }  \n        });\n        sectionAttendance.setAttribute('style', 'display:none');\n    \n        gradeformselect.value = 'none';\n        modStandardGrade.setAttribute('style', 'display:none');\n    }\n    \n}\n\nconst useVC = (e = ELEMENT_SELECTOR.useVC()) => {\n    let recordoptions = ELEMENT_SELECTOR.useVCRecord();\n    let typeVC = ELEMENT_SELECTOR.typeVC();\n    let sectionAccess = ELEMENT_SELECTOR.sectionAccess();\n    let accessformi = sectionAccess.getElementsByTagName('INPUT');\n    let sectionInitialStates = ELEMENT_SELECTOR.sectionInitialStates();\n    let initialformi = sectionInitialStates.getElementsByTagName('INPUT');\n    let sectionAudience = ELEMENT_SELECTOR.sectionAudience();\n    let participantList = ELEMENT_SELECTOR.participantList();\n\n    if (is_checkbox_checked(e) && is_element_displayed(e)) {\n        recordoptions.value = 1\n        typeVC.value = oldtypevc;\n        recordoptions.closest('.form-group').setAttribute('style', 'display:flex');\n        typeVC.closest('.form-group').setAttribute('style', 'display:flex');\n\n        accessformi.forEach(accesinput => {\n            if (accesinput.type !== 'hidden'&& accesinput.type !== 'text') {\n                accesinput.value = 1;\n            }  \n        });\n        sectionAccess.setAttribute('style', 'display:block')\n\n        initialformi.forEach(initialinput => {\n            if (initialinput.type !== 'hidden'&& initialinput.type !== 'text') {\n                initialinput.value = 1;\n            }  \n        });\n        sectionInitialStates.setAttribute('style', 'display:block')\n\n        if (typeof plistold !== 'undefined') {\n            participantList.value = plistold;\n        }\n        sectionAudience.setAttribute('style', 'display:block')\n\n    } else {\n        recordoptions.value = 0\n        oldtypevc = typeVC.value;\n        typeVC.value = 0;\n        recordoptions.closest('.form-group').setAttribute('style', 'display:none');\n        typeVC.closest('.form-group').setAttribute('style', 'display:none');\n        accessformi.forEach(accesinput => {\n            if (accesinput.type !== 'hidden') {\n                accesinput.value = 0;\n            }  \n        });\n        sectionAccess.setAttribute('style', 'display:none')\n\n        initialformi.forEach(initialinput => {\n            if (initialinput.type !== 'hidden') {\n                initialinput.value = 0;\n            }  \n        });\n        sectionInitialStates.setAttribute('style', 'display:none')\n\n        plistold = participantList.value;\n        participantList.value = '[]';\n        sectionAudience.setAttribute('style', 'display:none')\n    }\n    useVCRecord();\n}\n\nconst useVCRecord = (e = ELEMENT_SELECTOR.useVCRecord()) => {\n    let recordOptions = ELEMENT_SELECTOR.recordOptions();\n    let formi = recordOptions.getElementsByTagName('INPUT');\n    if (is_checkbox_checked(e) && is_element_displayed(e)) {\n        formi.forEach(input => {\n            if (input.type !== 'hidden' && input.type !== 'text') {\n                input.value = 1;\n            }  \n        });\n        recordOptions.setAttribute('style', 'display:block');\n    } else {\n        formi.forEach(input => {\n            if (input.type !== 'hidden') {\n                input.value = 0;\n            }  \n        });\n        recordOptions.setAttribute('style', 'display:none');\n    }\n    \n}\n\nconst is_checkbox_checked = (e) => {\n    if (e.target !== undefined) {\n        return e.target.checked;\n    } return e.checked;\n}\n\nconst is_element_displayed = (e) => {\n    let displayed;\n    e.target !== undefined ? displayed = window.getComputedStyle(e.target.closest('.form-group'), null).display\n        : displayed = window.getComputedStyle(e.closest('.form-group'), null).display;\n    return displayed != 'none';\n}\n"],"names":["ELEMENT_SELECTOR","document","getElementById","getElementsByName","oldtypevc","value","useVC","useAttendance","useSessionsScheduling","addEventListener","e","useVCRecord","querySelector","disabled","sessionscheduling","sectionsessions","closest","is_checkbox_checked","is_element_displayed","setAttribute","checked","sectionAttendance","formi","getElementsByTagName","modStandardGrade","gradeformselect","forEach","input","type","recordoptions","typeVC","sectionAccess","accessformi","sectionInitialStates","initialformi","sectionAudience","participantList","accesinput","initialinput","plistold","recordOptions","undefined","target","displayed","window","getComputedStyle","display"],"mappings":"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"}