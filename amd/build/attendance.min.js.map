{"version":3,"file":"attendance.min.js","sources":["../src/attendance.js"],"sourcesContent":["define([\n    'core/ajax'\n], function(ajax) {\n    const manualattendance = async(e) => {\n        var att = e.currentTarget;\n        var attid = att.closest('tr').querySelector('[id^=\"' + 'attendance' + '\"]').value;\n        if (att.checked) {\n            set_manual_attendance(attid, 1);\n        } else {\n            set_manual_attendance(attid, 0);\n        }\n    };\n\n    /**\n     * Sets manual attendance\n     *\n     * @param {integer} attid\n     * @param {array} status\n     * @returns response with the modified slot information.\n     */\n    const set_manual_attendance = (attid, status) => ajax.call([{\n        methodname: 'mod_hybridteaching_set_manual_attendance',\n        args: {\n            attid,\n            status,\n        },\n    }])[0].done(response => {\n        return response;\n    }).fail(err => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n    });\n\n    return {\n        init: () => {\n            window.addEventListener(\"beforeunload\", (e) => {\n                e.stopImmediatePropagation();\n            }, true);\n            if (document.getElementById('id_perpage') !== null) {\n                document.getElementById('id_perpage').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_attfilter') !== null) {\n                document.getElementById('id_attfilter').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_groupid') !== null) {\n                document.getElementById('id_groupid').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_selectedsession') !== null) {\n                document.getElementById('id_selectedsession').onchange = function() {\n                    let formPrefix = 'sessionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_selecteduser') !== null) {\n                document.getElementById('id_selecteduser').onchange = function() {\n                    let formPrefix = 'sessionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            var manualatt = document.querySelectorAll('.attendance-validated');\n            manualatt.forEach(att => {\n                att.addEventListener('change', manualattendance, true);\n            });\n        }\n    };\n});\n"],"names":["define","ajax","manualattendance","async","att","e","currentTarget","attid","closest","querySelector","value","checked","set_manual_attendance","status","call","methodname","args","done","response","fail","err","console","log","init","window","addEventListener","stopImmediatePropagation","document","getElementById","onchange","formElement","submit","querySelectorAll","forEach"],"mappings":"AAAAA,uCAAO,CACH,cACD,SAASC,YACFC,iBAAmBC,MAAAA,QACjBC,IAAMC,EAAEC,cACRC,MAAQH,IAAII,QAAQ,MAAMC,cAAc,sBAAgCC,MACxEN,IAAIO,QACJC,sBAAsBL,MAAO,GAE7BK,sBAAsBL,MAAO,IAW/BK,sBAAwB,CAACL,MAAOM,SAAWZ,KAAKa,KAAK,CAAC,CACxDC,WAAY,2CACZC,KAAM,CACFT,MAAAA,MACAM,OAAAA,WAEJ,GAAGI,MAAKC,UACDA,WACRC,MAAKC,MAEJC,QAAQC,IAAIF,cAGT,CACHG,KAAM,KACFC,OAAOC,iBAAiB,gBAAiBpB,IACrCA,EAAEqB,8BACH,GAC2C,OAA1CC,SAASC,eAAe,gBACxBD,SAASC,eAAe,cAAcC,SAAW,eAEzCC,YAAcH,SAASlB,cAAc,uBACrCqB,aACAA,YAAYC,WAIwB,OAA5CJ,SAASC,eAAe,kBACxBD,SAASC,eAAe,gBAAgBC,SAAW,eAE3CC,YAAcH,SAASlB,cAAc,uBACrCqB,aACAA,YAAYC,WAIsB,OAA1CJ,SAASC,eAAe,gBACxBD,SAASC,eAAe,cAAcC,SAAW,eAEzCC,YAAcH,SAASlB,cAAc,uBACrCqB,aACAA,YAAYC,WAI8B,OAAlDJ,SAASC,eAAe,wBACxBD,SAASC,eAAe,sBAAsBC,SAAW,eAEjDC,YAAcH,SAASlB,cAAc,wBACrCqB,aACAA,YAAYC,WAI2B,OAA/CJ,SAASC,eAAe,qBACxBD,SAASC,eAAe,mBAAmBC,SAAW,eAE9CC,YAAcH,SAASlB,cAAc,wBACrCqB,aACAA,YAAYC,WAIRJ,SAASK,iBAAiB,yBAChCC,SAAQ7B,MACdA,IAAIqB,iBAAiB,SAAUvB,kBAAkB"}