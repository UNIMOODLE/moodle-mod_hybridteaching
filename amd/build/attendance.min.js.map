{"version":3,"file":"attendance.min.js","sources":["../src/attendance.js"],"sourcesContent":["define([\n    'core/ajax'\n], function(ajax) {\n    const manualattendance = async(e) => {\n        var att = e.currentTarget;\n        var attid = att.closest('tr').querySelector('[id^=\"' + 'attendance' + '\"]').value;\n        var id = document.getElementsByName('id')[0].value;\n        if (att.checked) {\n            set_manual_attendance(attid, 1, id);\n        } else {\n            set_manual_attendance(attid, 0, id);\n        }\n    };\n\n    /**\n     * Sets manual attendance\n     *\n     * @param {integer} attid\n     * @param {array} status\n     * @param {string} id (cmid)\n     * @returns response with the modified slot information.\n     */\n    const set_manual_attendance = (attid, status, id) => ajax.call([{\n        methodname: 'mod_hybridteaching_set_manual_attendance',\n        args: {\n            attid,\n            status,\n            id,\n        },\n    }])[0].done(response => {\n        return response;\n    }).fail(err => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n    });\n\n    return {\n        init: () => {\n            window.addEventListener(\"beforeunload\", (e) => {\n                e.stopImmediatePropagation();\n            }, true);\n            if (document.getElementById('id_perpage') !== null) {\n                document.getElementById('id_perpage').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_attfilter') !== null) {\n                document.getElementById('id_attfilter').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_groupid') !== null) {\n                document.getElementById('id_groupid').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_selectedsession') !== null) {\n                document.getElementById('id_selectedsession').onchange = function() {\n                    let formPrefix = 'sessionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_selecteduser') !== null) {\n                document.getElementById('id_selecteduser').onchange = function() {\n                    let formPrefix = 'sessionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            var manualatt = document.querySelectorAll('.attendance-validated');\n            manualatt.forEach(att => {\n                att.addEventListener('change', manualattendance, true);\n            });\n        }\n    };\n});\n"],"names":["define","ajax","manualattendance","async","att","e","currentTarget","attid","closest","querySelector","value","id","document","getElementsByName","checked","set_manual_attendance","status","call","methodname","args","done","response","fail","err","console","log","init","window","addEventListener","stopImmediatePropagation","getElementById","onchange","formElement","submit","querySelectorAll","forEach"],"mappings":"AAAAA,uCAAO,CACH,cACD,SAASC,YACFC,iBAAmBC,MAAAA,QACjBC,IAAMC,EAAEC,cACRC,MAAQH,IAAII,QAAQ,MAAMC,cAAc,sBAAgCC,MACxEC,GAAKC,SAASC,kBAAkB,MAAM,GAAGH,MACzCN,IAAIU,QACJC,sBAAsBR,MAAO,EAAGI,IAEhCI,sBAAsBR,MAAO,EAAGI,KAYlCI,sBAAwB,CAACR,MAAOS,OAAQL,KAAOV,KAAKgB,KAAK,CAAC,CAC5DC,WAAY,2CACZC,KAAM,CACFZ,MAAAA,MACAS,OAAAA,OACAL,GAAAA,OAEJ,GAAGS,MAAKC,UACDA,WACRC,MAAKC,MAEJC,QAAQC,IAAIF,cAGT,CACHG,KAAM,KACFC,OAAOC,iBAAiB,gBAAiBvB,IACrCA,EAAEwB,8BACH,GAC2C,OAA1CjB,SAASkB,eAAe,gBACxBlB,SAASkB,eAAe,cAAcC,SAAW,eAEzCC,YAAcpB,SAASH,cAAc,uBACrCuB,aACAA,YAAYC,WAIwB,OAA5CrB,SAASkB,eAAe,kBACxBlB,SAASkB,eAAe,gBAAgBC,SAAW,eAE3CC,YAAcpB,SAASH,cAAc,uBACrCuB,aACAA,YAAYC,WAIsB,OAA1CrB,SAASkB,eAAe,gBACxBlB,SAASkB,eAAe,cAAcC,SAAW,eAEzCC,YAAcpB,SAASH,cAAc,uBACrCuB,aACAA,YAAYC,WAI8B,OAAlDrB,SAASkB,eAAe,wBACxBlB,SAASkB,eAAe,sBAAsBC,SAAW,eAEjDC,YAAcpB,SAASH,cAAc,wBACrCuB,aACAA,YAAYC,WAI2B,OAA/CrB,SAASkB,eAAe,qBACxBlB,SAASkB,eAAe,mBAAmBC,SAAW,eAE9CC,YAAcpB,SAASH,cAAc,wBACrCuB,aACAA,YAAYC,WAIRrB,SAASsB,iBAAiB,yBAChCC,SAAQ/B,MACdA,IAAIwB,iBAAiB,SAAU1B,kBAAkB"}