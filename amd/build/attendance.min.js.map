{"version":3,"file":"attendance.min.js","sources":["../src/attendance.js"],"sourcesContent":["define([\n    'core/ajax',\n], function(ajax) {\n    const manualattendance = (e) => {\n        att = e.currentTarget;\n        attid = att.closest('tr').querySelector('[id^=\"' + 'attendance' + '\"]').value\n        if (att.checked) {\n            if (confirm('yes')) {\n                console.log('y');\n                set_manual_attendance(attid, 1);\n            }  else {\n                att.checked = false;\n            }\n        } else {\n            if (confirm('no')) {\n                console.log('n');\n                set_manual_attendance(attid, 0);\n            }  else {\n                att.checked = true;\n            }\n        }\n    } \n\n    /**\n     * Sets manual attendance\n     * \n     * @param {integer} attid\n     * @param {array} status\n     * @returns response with the modified slot information.\n     */\n    const set_manual_attendance = (attid, status) => ajax.call([{\n        methodname: 'mod_hybridteaching_set_manual_attendance',\n        args: {\n            attid,\n            status,\n        },\n    }])[0].done(response => {\n        return response;\n    }).fail(err => {\n        console.log(err);\n    });\n\n    return {\n        init: () => {\n            if (document.getElementById('id_perpage') != null) {\n                document.getElementById('id_perpage').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_attfilter') != null) {\n                document.getElementById('id_attfilter').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_groupid') != null) {\n                document.getElementById('id_groupid').onchange = function() {\n                    let formPrefix = 'optionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_selectedsession') != null) {\n                document.getElementById('id_selectedsession').onchange = function() {\n                    let formPrefix = 'sessionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            if (document.getElementById('id_selecteduser') != null) {\n                document.getElementById('id_selecteduser').onchange = function() {\n                    let formPrefix = 'sessionsform';\n                    let formElement = document.querySelector('[id^=\"' + formPrefix + '\"]');\n                    if (formElement) {\n                        formElement.submit();\n                    }\n                };\n            }\n            manualatt = document.querySelectorAll('.attendance-validated');\n            manualatt.forEach(att => {\n                att.addEventListener('change', manualattendance, true); \n            });\n        }\n    }\n});"],"names":["define","ajax","manualattendance","e","att","currentTarget","attid","closest","querySelector","value","checked","confirm","console","log","set_manual_attendance","status","call","methodname","args","done","response","fail","err","init","document","getElementById","onchange","formElement","submit","manualatt","querySelectorAll","forEach","addEventListener"],"mappings":"AAAAA,uCAAO,CACH,cACD,SAASC,YACFC,iBAAoBC,IACtBC,IAAMD,EAAEE,cACRC,MAAQF,IAAIG,QAAQ,MAAMC,cAAc,sBAAgCC,MACpEL,IAAIM,QACAC,QAAQ,QACRC,QAAQC,IAAI,KACZC,sBAAsBR,MAAO,IAE7BF,IAAIM,SAAU,EAGdC,QAAQ,OACRC,QAAQC,IAAI,KACZC,sBAAsBR,MAAO,IAE7BF,IAAIM,SAAU,GAYpBI,sBAAwB,CAACR,MAAOS,SAAWd,KAAKe,KAAK,CAAC,CACxDC,WAAY,2CACZC,KAAM,CACFZ,MAAAA,MACAS,OAAAA,WAEJ,GAAGI,MAAKC,UACDA,WACRC,MAAKC,MACJV,QAAQC,IAAIS,cAGT,CACHC,KAAM,KAC2C,MAAzCC,SAASC,eAAe,gBACxBD,SAASC,eAAe,cAAcC,SAAW,eAEzCC,YAAcH,SAAShB,cAAc,uBACrCmB,aACAA,YAAYC,WAIuB,MAA3CJ,SAASC,eAAe,kBACxBD,SAASC,eAAe,gBAAgBC,SAAW,eAE3CC,YAAcH,SAAShB,cAAc,uBACrCmB,aACAA,YAAYC,WAIqB,MAAzCJ,SAASC,eAAe,gBACxBD,SAASC,eAAe,cAAcC,SAAW,eAEzCC,YAAcH,SAAShB,cAAc,uBACrCmB,aACAA,YAAYC,WAI6B,MAAjDJ,SAASC,eAAe,wBACxBD,SAASC,eAAe,sBAAsBC,SAAW,eAEjDC,YAAcH,SAAShB,cAAc,wBACrCmB,aACAA,YAAYC,WAI0B,MAA9CJ,SAASC,eAAe,qBACxBD,SAASC,eAAe,mBAAmBC,SAAW,eAE9CC,YAAcH,SAAShB,cAAc,wBACrCmB,aACAA,YAAYC,WAIxBC,UAAYL,SAASM,iBAAiB,yBACtCD,UAAUE,SAAQ3B,MACdA,IAAI4B,iBAAiB,SAAU9B,kBAAkB"}