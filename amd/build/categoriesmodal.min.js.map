{"version":3,"file":"categoriesmodal.min.js","sources":["../src/categoriesmodal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n *\n * @module   local_notificationsagent/assigntemplate\n * @copyright 2023, ISYC\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['core/str'], function(str) {\n    return {\n\n        init: function() {\n            $('#categoriesmodal').on('shown.bs.modal', function() {\n                var cat = $('#categories').val();\n                if (cat.length != 0) {\n                    var categories = JSON.parse(cat);\n                    if (categories.length != 0) {\n                        categories.forEach(function(categoryId) {\n                            $('#checkboxcategory-' + categoryId).prop('checked', true);\n                        });\n                    }\n                }\n            });\n\n            $('#categoriesmodal .collapse').on('show.bs.collapse', function () {\n                $(this).parents('.listitem-category').removeClass('collapsed');\n            });\n            $('#categoriesmodal .collapse').on('hide.bs.collapse', function () {\n                $(this).parents('.listitem-category').addClass('collapsed');\n            });\n\n            /* checkbox */\n            $('#categoriesmodal #course-category-select-all').on('click', function(){\n                var checkassign = $('#categoriesmodal .category-listing .custom-control-input');\n                checkassign.prop('checked', $(this).prop('checked'));\n            });\n            $('#categoriesmodal .category-listing').on('change', 'input[type=checkbox]', function () {\n                var checkssubcategoriescourses = '#category-listing-content-'+$(this).attr(\"id\").replace('checkboxcategory-', '')+' .custom-control-input';\n                $('#categoriesmodal .category-listing '+checkssubcategoriescourses).prop('checked', $(this).prop('checked'));\n            });\n\n            $('#categoriesmodal #savecategoriesmodal').on('click', function() {\n                var data = {};\n                data['category'] = [];\n                var allCategories = [];\n                let mainCategories = $('#categoriesmodal #category-listing-content-0 > li[id^=\"listitem-category-\"]').has('input[id^=\"checkboxcategory-\"]:checked');\n\n                mainCategories.each(function() {\n                    let items = $('#' + this.id + ' input[id^=\"checkboxcategory-\"]:checked').map(function() {\n                        let id = $(this).attr('id').replace('checkboxcategory-', '');\n                        let parent = $(this).data('parent').replace('#category-listing-content-', '');\n\n                        if ($.inArray(id, allCategories) === -1) {\n                            allCategories.push(id);\n                        }\n                            \n                        return {id: id, parent: parent};\n                    }).get();\n\n                    $.grep(items, function(item) {\n                        data['category'].push(item.id);\n                    });\n                });\n                $('#categories').val(data['category']);\n                $('#categoriesmodal').modal('hide');\n            });\n        },\n        loopatfirstparent: function(idparent, arrayParents = []){\n            var module = this;\n            \n            if(idparent != '#category-listing-content-0'){\n                arrayParents.push(idparent.replace('#category-listing-content-', ''));\n                var dataparent = $('#categoriesmodal .category-listing #listitem-category-'+idparent.replace('#category-listing-content-', '')+' > .category-listing-header .custom-control-input').attr('data-parent');\n                return module.loopatfirstparent(dataparent, arrayParents);\n            }else{\n                return arrayParents;\n            }\n        }\n    };\n});\n"],"names":["define","str","init","$","on","cat","val","length","categories","JSON","parse","forEach","categoryId","prop","this","parents","removeClass","addClass","checkssubcategoriescourses","attr","replace","data","allCategories","has","each","items","id","map","parent","inArray","push","get","grep","item","modal","loopatfirstparent","idparent","arrayParents","module","dataparent"],"mappings":";;;;;;AAsBAA,4CAAO,CAAC,aAAa,SAASC,WACnB,CAEHC,KAAM,WACFC,EAAE,oBAAoBC,GAAG,kBAAkB,eACnCC,IAAMF,EAAE,eAAeG,SACT,GAAdD,IAAIE,OAAa,KACbC,WAAaC,KAAKC,MAAML,KACH,GAArBG,WAAWD,QACXC,WAAWG,SAAQ,SAASC,YACxBT,EAAE,qBAAuBS,YAAYC,KAAK,WAAW,UAMrEV,EAAE,8BAA8BC,GAAG,oBAAoB,WACnDD,EAAEW,MAAMC,QAAQ,sBAAsBC,YAAY,gBAEtDb,EAAE,8BAA8BC,GAAG,oBAAoB,WACnDD,EAAEW,MAAMC,QAAQ,sBAAsBE,SAAS,gBAInDd,EAAE,gDAAgDC,GAAG,SAAS,WACxCD,EAAE,4DACRU,KAAK,UAAWV,EAAEW,MAAMD,KAAK,eAE7CV,EAAE,sCAAsCC,GAAG,SAAU,wBAAwB,eACrEc,2BAA6B,6BAA6Bf,EAAEW,MAAMK,KAAK,MAAMC,QAAQ,oBAAqB,IAAI,yBAClHjB,EAAE,sCAAsCe,4BAA4BL,KAAK,UAAWV,EAAEW,MAAMD,KAAK,eAGrGV,EAAE,yCAAyCC,GAAG,SAAS,eAC/CiB,KAAO,CACXA,SAAmB,IACfC,cAAgB,GACCnB,EAAE,+EAA+EoB,IAAI,0CAE3FC,MAAK,eACZC,MAAQtB,EAAE,IAAMW,KAAKY,GAAK,2CAA2CC,KAAI,eACrED,GAAKvB,EAAEW,MAAMK,KAAK,MAAMC,QAAQ,oBAAqB,IACrDQ,OAASzB,EAAEW,MAAMO,KAAK,UAAUD,QAAQ,6BAA8B,WAEpC,IAAlCjB,EAAE0B,QAAQH,GAAIJ,gBACdA,cAAcQ,KAAKJ,IAGhB,CAACA,GAAIA,GAAIE,OAAQA,WACzBG,MAEH5B,EAAE6B,KAAKP,OAAO,SAASQ,MACnBZ,KAAI,SAAaS,KAAKG,KAAKP,UAGnCvB,EAAE,eAAeG,IAAIe,KAAI,UACzBlB,EAAE,oBAAoB+B,MAAM,YAGpCC,kBAAmB,SAASC,cAAUC,oEAAe,OAC7CC,OAASxB,QAEE,+BAAZsB,SAA0C,CACzCC,aAAaP,KAAKM,SAAShB,QAAQ,6BAA8B,SAC7DmB,WAAapC,EAAE,yDAAyDiC,SAAShB,QAAQ,6BAA8B,IAAI,qDAAqDD,KAAK,sBAClLmB,OAAOH,kBAAkBI,WAAYF,qBAErCA"}